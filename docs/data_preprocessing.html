<!--
=========================================================
* * Black Dashboard - v1.0.1
=========================================================

* Product Page: https://www.creative-tim.com/product/black-dashboard
* Copyright 2019 Creative Tim (https://www.creative-tim.com)


* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/favicon.png">
  <title>
    European Hotel Analysis
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,600,700,800" rel="stylesheet" />
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <!-- Nucleo Icons -->
  <link href="./assets/css/nucleo-icons.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link href="./assets/css/black-dashboard.css?v=1.0.0" rel="stylesheet" />
</head>

<body class="">
  <div class="wrapper">
    <div class="sidebar">
      <div class="sidebar-wrapper">
        <div class="logo">
          <a href="javascript:void(0)" class="simple-text logo-mini">
            EHA
          </a>
          <a href="javascript:void(0)" class="simple-text logo-normal">
            Hotel Analysis
          </a>
        </div>
        <ul class="nav" style="list-style-type: none">
          <li>
            <a href="./index.html">
              <i class="tim-icons icon-world"></i>
              <p>Home</p>
            </a>
          </li>
          <li>
            <a href="./dashboard.html">
              <i class="tim-icons icon-chart-pie-36"></i>
              <p>Dashboard</p>
            </a>
          </li>
          <li>
            <a href="./machine_learning.html">
              <i class="tim-icons icon-atom"></i>
              <p>Machine Learning</p>
            </a>
          </li>
          <li>
            <a href="./data_preprocessing.html">
              <i class="tim-icons icon-align-left-2"></i>
              <p>Data Preprocessing</p>
            </a>
          </li>
          <li>
            <a href="./database.html">
              <i class="tim-icons icon-vector"></i>
              <p>Database</p>
            </a>
          </li>
          <li>
            <a href="./documentation.html">
              <i class="tim-icons icon-single-copy-04"></i>
              <p>Documentation</p>
          </li>    
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-absolute navbar-transparent">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <div class="navbar-toggle d-inline">
              <button type="button" class="navbar-toggler">
                <span class="navbar-toggler-bar bar1"></span>
                <span class="navbar-toggler-bar bar2"></span>
                <span class="navbar-toggler-bar bar3"></span>
              </button>
            </div>
              <div>
                <a class="navbar-brand" href="javascript:void(0)">
                  <h2><i class="tim-icons icon-align-left-2"></i> Data Preprocessing</h2>
                </a>
              </div>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-bar navbar-kebab"></span>
            <span class="navbar-toggler-bar navbar-kebab"></span>
            <span class="navbar-toggler-bar navbar-kebab"></span>
          </button>
          <div class="collapse navbar-collapse" id="navigation">
            <ul class="navbar-nav ml-auto">
              <li class="separator d-lg-none"></li>
            </ul>
          </div>
        </div>
      </nav>
      <div class="modal modal-search fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="searchModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <input type="text" class="form-control" id="inlineFormInputGroup" placeholder="SEARCH">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <i class="tim-icons icon-simple-remove"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
<!-- End Navbar -->
      <div class="content">
        <div class="row" >
          <div class="col-12">
            <div class="card card-chart">
              <div class="card-header ">
                <h1> Data Preprocessing </h1>
              </div>
            </div>
          </div>
        </div> 
        <div class="row" >
          <div class="col-12">
            <div class="card card-chart">
              <div class="card-header ">
                <h4> Step 1: Observe the source data - While observing the Source file: Hotel_Reviews.csv in a pandas DataFrame </h4>
                <ul>
                  <li>Data contains 515738 rows Ã— 17 columns</li><br>
                  <ul><img src="assets/img/source_data.png" alt="source_data"></ul><br>
                  <li>The 17 columns and corresponding data types were</li><br>
                  <ul><img src="assets/img/source_data_dtypes.png" alt="source_data_dtypes"></ul>
                </ul>

                <h4> Step 2: Since there was no unique column in the table, we used the pandas dataframe index to creae a unique column 'Review_Id' for working with data in PostgreSQL </h4>
                <ul>
                  <code>hotel_df.index.name='Review_Id'</code>
                </ul>
                
                <h4>Step 3: Remove null values</h4>
                <ul>
                  <h5>Step 3.1: Check for null/na values</h5>
                  <ul><code>hotel_df.isnull().sum()</code></ul>
                </ul>
                <ul>
                  <h5>Step 3.2: Drop rows that are na/null and reset the index from 0</h5>
                  <ul><code>hotel_df = hotel_df.dropna().reset_index(drop=True)</code></ul>
                </ul>
                <ul>
                  <h5>Step 3.3: The operation above will delete the index name, so renaming it again as 'Review_Id'</h5>
                  <ul><code>hotel_df.index.name='Review_Id'</code></ul>
                </ul>
                <ul>
                  <h5>Step 3.4: Check for null again</h5>
                  <ul><code>hotel_df.isnull().sum()</code></ul>
                </ul>
              
                <h4>Step 4: We found that, for best project efficiency, the 17 columns could be divided into two groups: 'review group' and 'location group' with the review group having information pertaining to reviews only, and the location group with information pertaining to location only.</h4>
                <p>Breaking the big table into 2 tables: 1st with hotel reviews, 2nd with hotel locations</p>
                <ul>
                  <h5>Step 4.1: Create Table 1: Hotel reviews only - no location data (drop columns 'lat'and 'lng')</h5>
                  <ul><code> 
                    # hotel reviws without lat and lng <br>
                    hotel_reviews = hotel_df.drop(columns=['lat','lng'])<br><br>
                    #view the table <br>
                    hotel_reviews
                  </code></ul><br>
                  <ul><img src="assets/img/Table1_review.png" alt="Table1_review"></ul>
                </ul>
                <ul>
                  <h5>Step 4.2: Create Table 2: DF with locations (no reviews)</h5>
                  <ul><code>
                    # creating a subset of the dataframe with unique values on the column 'Hotel_Address' and then reset the index to 0<br>
                    unique_address_df = hotel_df.drop_duplicates(subset=['Hotel_Address']).reset_index(drop=True) <br><br>
                
                    # view the table<br>
                    unique_address_df
                  </code></ul><br>
                  <ul><img src="assets/img/Table2_selecting_unique_hotels.png" alt="Table2_selecting_unique_hotels"></ul>
                </ul>
                <ul>
                  <h5>Step 4.3: Select only 4 columns that we want - "Hotel_Address", "Hotel_Name", "lat", "lng"</h5>
                  <ul><code>
                    # selecting the ONLY 4 required columns<br>
                    hotel_location = unique_address_df[["Hotel_Address", "Hotel_Name", "lat", "lng"]]<br><br>
                
                    #view the table<br>
                    hotel_location
                  </code></ul><br>
                  <ul><img src="assets/img/Table2b_retaining_only_4_clmns.png" alt="Table2b_retaining_only_4_clmns"></ul>
                </ul>
 
                <h4>Step 5: Create sample tables with 1000 rows</h4>
                <ul>
                  <h5>Step 5.1: Table 1: review table - selecting the first 1000 rows</h5>
                  <ul><code> 
                    # creating a sample of table 2, with 1000 rows<br>
                    sample_of_hotel_location = hotel_location.loc[0:999]<br><br>
                
                    # view the table<br>
                    sample_of_hotel_location<br>
                  </code></ul><br>
                  <ul><img src="assets/img/Table1_1000rows.png" alt="Table1_1000rows"></ul>
                </ul>
                <ul>
                  <h5>Step 5.2: Table 2: location table - selecting the first 1000 rows</h5>
                  <ul><code>
                    # creating a sample of table 1, with 1000 rows<br>
                    sample_of_hotel_reviews = hotel_reviews.loc[0:999]<br><br>
                
                    # view the table<br>
                    sample_of_hotel_reviews
                  </code></ul><br>
                  <ul><img src="assets/img/Table2_1000rows.png" alt="Table2_1000rows"></ul>
                </ul>
              
                <h4>Step 6: Extract city and country using lat and lng, using geopy</h4>
                <ul>
                  <h5>Step 6.1: Create 2 new columns for City and Country</h5>
                  <ul><code> 
                    # creating 2 new columns<br>
                    hotel_location_city_country["City"] = ""<br>
                    hotel_location_city_country["Country"] = ""<br><br>
                
                    # view the df<br>
                    hotel_location_city_country
                  </code></ul><br>
                  <ul><img src="assets/img/Table2_creating2newcolumns.png" alt="Table2_creating2newcolumns"></ul>
                </ul>
                <ul>
                  <h5>Step 6.2: Install GeoPy</h5>
                  <ul><code>
                    # install the module geopy<br>
                    ! pip install geopy<br><br>
                
                    # import module<br> 
                    from geopy.geocoders import Nominatim<br><br>
                
                    # initialize Nominatim API <br> 
                    geolocator = Nominatim(user_agent="geoapiExercises")
                  </code></ul>
                </ul>
                <ul>
                  <h5>Step 6.3: Create a for loop to iterate through the rows, use the co-ordinates to pull the 'city' and 'county' and store them in the 'city' and 'country' columns</h5>
                  <ul><code>
                    # declare a variable to iterate over the rows<br> 
                    i=0<br> <br> 
                
                    # loop for extracting city and county from the data using GeoPy<br> 
                    for row in hotel_location_city_country.itertuples():<br> 
                    <ul>Latitude = str(row.lat)<br> 
                        Longitude = str(row.lng)<br> <br> 
                    
                        location = geolocator.reverse(Latitude+","+Longitude) <br> 
                        address = location.raw['address'] <br> <br> 
                
                        # traverse the data <br> 
                        city = address.get('city', '') <br> 
                        state = address.get('state', '') <br> 
                        country = address.get('country', '') <br> 
                        code = address.get('country_code') <br> 
                        zipcode = address.get('postcode') <br> <br> 
                
                        print(f"Hotel {i+1}: Co-ordinates ({Latitude}, {Longitude}) | City: {city}, {country}")<br> <br> 
                        
                        hotel_location_city_country.at[i, 'City'] = city<br> 
                        hotel_location_city_country.at[i, 'Country'] = country<br> 
                        i+=1<br> 
                    </ul>
                    # view the df<br> 
                    hotel_location_city_country
                  </code></ul><br>
                  <ul><img src="assets/img/Table2_with_city_country.png" alt="Table2_with_city_country"></ul>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row" >
          <div class="col-12">
            <div class="card card-chart">
              <div class="card-header ">
                <h3>Next Step </h3>
                <p>At the end of each ipynb file, the new tables were stored in Zip files. </p>
                <p>The next step would be <a href="https://github.com/JagpreetBath/European_Hotel_Analysis/tree/main/DataBase" target="_blank">Storing the tables in Database</a></p>
              </div>
            </div>
          </div>
        </div>  
      </div>  
  <div class="fixed-plugin">
    <div class="dropdown show-dropdown">
      <a href="#" data-toggle="dropdown">
        <i class="fa fa-cog fa-2x"> </i>
      </a>
      <ul class="dropdown-menu">
        <li class="header-title"> Sidebar Background</li>
        <li class="adjustments-line">
          <a href="javascript:void(0)" class="switch-trigger background-color">
            <div class="badge-colors text-center">
              <span class="badge filter badge-primary active" data-color="primary"></span>
              <span class="badge filter badge-info" data-color="blue"></span>
              <span class="badge filter badge-success" data-color="green"></span>
            </div>
            <div class="clearfix"></div>
          </a>
        </li>
        <li class="adjustments-line text-center color-change">
          <span class="color-label">LIGHT MODE</span>
          <span class="badge light-badge mr-2"></span>
          <span class="badge dark-badge ml-2"></span>
          <span class="color-label">DARK MODE</span>
        </li>
      </ul>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="./assets/js/core/jquery.min.js"></script>
  <script src="./assets/js/core/popper.min.js"></script>
  <script src="./assets/js/core/bootstrap.min.js"></script>
  <script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <script src="./assets/js/black-dashboard.min.js?v=1.0.0"></script>
  <script>
    $(document).ready(function() {
      $().ready(function() {
        $sidebar = $('.sidebar');
        $navbar = $('.navbar');
        $main_panel = $('.main-panel');

        $full_page = $('.full-page');

        $sidebar_responsive = $('body > .navbar-collapse');
        sidebar_mini_active = true;
        white_color = false;

        window_width = $(window).width();

        fixed_plugin_open = $('.sidebar .sidebar-wrapper .nav li.active a p').html();



        $('.fixed-plugin a').click(function(event) {
          if ($(this).hasClass('switch-trigger')) {
            if (event.stopPropagation) {
              event.stopPropagation();
            } else if (window.event) {
              window.event.cancelBubble = true;
            }
          }
        });

        $('.fixed-plugin .background-color span').click(function() {
          $(this).siblings().removeClass('active');
          $(this).addClass('active');

          var new_color = $(this).data('color');

          if ($sidebar.length != 0) {
            $sidebar.attr('data', new_color);
          }

          if ($main_panel.length != 0) {
            $main_panel.attr('data', new_color);
          }

          if ($full_page.length != 0) {
            $full_page.attr('filter-color', new_color);
          }

          if ($sidebar_responsive.length != 0) {
            $sidebar_responsive.attr('data', new_color);
          }
        });

        $('.switch-sidebar-mini input').on("switchChange.bootstrapSwitch", function() {
          var $btn = $(this);

          if (sidebar_mini_active == true) {
            $('body').removeClass('sidebar-mini');
            sidebar_mini_active = false;
            blackDashboard.showSidebarMessage('Sidebar mini deactivated...');
          } else {
            $('body').addClass('sidebar-mini');
            sidebar_mini_active = true;
            blackDashboard.showSidebarMessage('Sidebar mini activated...');
          }

          // we simulate the window Resize so the charts will get updated in realtime.
          var simulateWindowResize = setInterval(function() {
            window.dispatchEvent(new Event('resize'));
          }, 180);

          // we stop the simulation of Window Resize after the animations are completed
          setTimeout(function() {
            clearInterval(simulateWindowResize);
          }, 1000);
        });

        $('.switch-change-color input').on("switchChange.bootstrapSwitch", function() {
          var $btn = $(this);

          if (white_color == true) {

            $('body').addClass('change-background');
            setTimeout(function() {
              $('body').removeClass('change-background');
              $('body').removeClass('white-content');
            }, 900);
            white_color = false;
          } else {

            $('body').addClass('change-background');
            setTimeout(function() {
              $('body').removeClass('change-background');
              $('body').addClass('white-content');
            }, 900);

            white_color = true;
          }


        });

        $('.light-badge').click(function() {
          $('body').addClass('white-content');
        });

        $('.dark-badge').click(function() {
          $('body').removeClass('white-content');
        });
      });
    });
  </script>
  <script src="https://cdn.trackjs.com/agent/v3/latest/t.js"></script>
  <script>
    window.TrackJS &&
      TrackJS.install({
        token: "ee6fab19c5a04ac1a32a645abde4613a",
        application: "black-dashboard-free"
      });
  </script>
</body>

</html>